This document is work in progress and describes the format of the simulation restart file when dccrg is used.

The file consists of a header and zero or more spatial cells.


Header format:

1 uint64_t: whether the file is written in big, little or some other endian format.
The value could be for example 0x0123456789ABCDEF.
Rationale:
Since cell numbers are uint64_t and coordinates are (always?) sizeof(uint64_t), using that here would catch even the most bizarre architectures.

1 double:   starting corner of the spatial grid in the x direction.

1 double:   starting corner of the spatial grid in the y direction.

1 double:   starting corner of the spatial grid in the z direction.

1 float:   starting corner of the velocity grid in each spatial cell in the x direction.

1 float:   starting corner of the velocity grid in each spatial cell in the y direction.

1 float:   starting corner of the velocity grid in each spatial cell in the z direction.

1 double:   size of an unrefined spatial cell in the x direction.

1 double:   size of an unrefined spatial cell in the y direction.

1 double:   size of an unrefined spatial cell in the z direction.

1 float:   size of an unrefined velocity block in each spatial cell in the x direction.

1 float:   size of an unrefined velocity block in each spatial cell in the y direction.

1 float:   size of an unrefined velocity block in each spatial cell in the z direction.

1 uint64_t: length of the spatial grid in unrefined cells in the x direction.

1 uint64_t: length of the spatial grid in unrefined cells in the y direction.

1 uint64_t: length of the spatial grid in unrefined cells in the z direction.

1 uint8_t:  length of the velocity grid in unrefined velocity blocks in each spatial cell in the x direction.

1 uint8_t:  length of the velocity grid in unrefined velocity blocks in each spatial cell in the y direction.

1 uint8_t:  length of the velocity grid in unrefined velocity blocks in each spatial cell in the z direction.

1 uint8_t:  maximum refinement level of the grid (0 means unrefined).

1 uint64_t: number of spatial cells stored in this file.
From now on N will be used to refer to this value.
If N = 0 then the file ends here.

N uint64_t: cells that are stored in this file.

N uint64_t: offsets in bytes from the beginning of this file marking where the data of every cell begins. The ith value here means the offset of the ith cell in the list above.


Next the data of spatial cells listed above (not necessarily in the listed order though) follows, with the format of each spatial cell being:

1 uint32_t: number of velocity blocks in this spatial cell.
From now on K will be used to refer to this value.
If K = 0 then this cell's data ends here.

Next follow the velocity blocks stored in this cell ordered from 0 to K - 1 as given by the function velblock in gridbuilder.cpp.
The format of each velocity block is:

64 float:   values of the distribution function in the velocity cells of this block, ordered from 0 to 63 as given by line 160 in gridbuilder.cpp (kc*WID2+jc*WID+ic, where kc, jc and ic have values [0, 3]).

